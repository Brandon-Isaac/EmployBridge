import{a as ne}from"./chunk-X7G6GFY2.js";import{b as te,c as ie}from"./chunk-C3DRYL2F.js";import{c as M,h as T}from"./chunk-QU4DUXWZ.js";import{a as ee}from"./chunk-V3S2WEL6.js";import{$e as Q,Bc as L,Ec as B,Ee as A,Fa as o,Fc as N,Hd as q,Ic as k,Ja as f,Jd as V,Je as R,Kc as O,Le as z,Oa as b,Sa as s,Ue as H,Ve as W,We as Y,Xd as D,Yd as G,Za as m,Ze as J,_e as K,ac as E,af as X,cf as Z,ff as $,gb as i,ha as _,hb as t,hc as P,ia as y,ib as d,ie as j,jf as re,mb as x,ob as h,pb as u,sc as F,uc as g,xb as a,xc as w,yb as S,yc as U,zb as I}from"./chunk-RCQKIGTM.js";function ae(r,e){if(r&1&&(i(0,"div",4),d(1,"fa-icon",5),i(2,"p"),a(3,"Loading company profile..."),t()()),r&2){let n=u();o(),m("icon",n.faSpinner)}}function me(r,e){if(r&1){let n=x();i(0,"div",6)(1,"mat-card",7)(2,"mat-card-content")(3,"p"),a(4),t(),i(5,"button",8),h("click",function(){_(n);let c=u();return y(c.retryLoading())}),a(6," Retry "),t()()()()}if(r&2){let n=u();o(4),S(n.error)}}function le(r,e){r&1&&(i(0,"mat-error"),a(1," Company name is required "),t())}function pe(r,e){r&1&&(i(0,"mat-error"),a(1," Industry is required "),t())}function de(r,e){r&1&&(i(0,"mat-error"),a(1," Description is required "),t())}function ce(r,e){r&1&&(i(0,"mat-error"),a(1," Location is required "),t())}function se(r,e){r&1&&(i(0,"mat-error"),a(1," Please enter a valid URL "),t())}function ue(r,e){if(r&1){let n=x();i(0,"mat-card",9)(1,"mat-card-header")(2,"mat-card-title"),a(3,"Update Company Profile"),t()(),i(4,"mat-card-content")(5,"form",10),h("ngSubmit",function(){_(n);let c=u();return y(c.onSubmit())}),i(6,"div",11)(7,"mat-form-field",12)(8,"mat-label"),a(9,"Company Name"),t(),d(10,"input",13),s(11,le,2,0,"mat-error",14),t(),i(12,"mat-form-field",12)(13,"mat-label"),a(14,"Industry"),t(),d(15,"input",15),i(16,"mat-icon",16),d(17,"fa-icon",17),t(),s(18,pe,2,0,"mat-error",14),t()(),i(19,"mat-form-field",18)(20,"mat-label"),a(21,"Description"),t(),d(22,"textarea",19),s(23,de,2,0,"mat-error",14),t(),i(24,"div",11)(25,"mat-form-field",12)(26,"mat-label"),a(27,"Location"),t(),d(28,"input",20),i(29,"mat-icon",16),d(30,"fa-icon",17),t(),s(31,ce,2,0,"mat-error",14),t(),i(32,"mat-form-field",12)(33,"mat-label"),a(34,"Website"),t(),d(35,"input",21),i(36,"mat-icon",16),d(37,"fa-icon",17),t(),s(38,se,2,0,"mat-error",14),t()(),i(39,"div",22)(40,"button",23),h("click",function(){_(n);let c=u();return y(c.onCancel())}),a(41,"Cancel"),t(),i(42,"button",24),a(43),t()()()()()}if(r&2){let n,p,c,C,v,l=u();o(5),m("formGroup",l.updateForm),o(6),m("ngIf",(n=l.updateForm.get("name"))==null?null:n.hasError("required")),o(6),m("icon",l.faBuilding),o(),m("ngIf",(p=l.updateForm.get("industry"))==null?null:p.hasError("required")),o(5),m("ngIf",(c=l.updateForm.get("description"))==null?null:c.hasError("required")),o(7),m("icon",l.faLocationDot),o(),m("ngIf",(C=l.updateForm.get("location"))==null?null:C.hasError("required")),o(6),m("icon",l.faGlobe),o(),m("ngIf",(v=l.updateForm.get("website"))==null?null:v.hasError("pattern")),o(4),m("disabled",l.updateForm.invalid||l.isSubmitting),o(),I(" ",l.isSubmitting?"Updating...":"Update Profile"," ")}}var oe=class r{constructor(e,n,p,c,C){this.fb=e;this.companyService=n;this.authService=p;this.router=c;this.snackBar=C;this.updateForm=this.fb.group({name:["",g.required],description:["",g.required],industry:["",g.required],location:["",g.required],website:["",[g.pattern("https?://.+")]]})}updateForm;isLoading=!0;isSubmitting=!1;error=null;companyId=null;faBuilding=z;faLocationDot=A;faGlobe=j;faSpinner=R;ngOnInit(){let e=this.authService.getCurrentUser();if(!e||e.role!=="employer"){this.error="You must be logged in as a company to update the profile",this.isLoading=!1,this.router.navigate(["/login"]);return}this.companyService.getCompanyByUserId(e.id).subscribe({next:n=>{this.companyId=n.id,this.loadCompanyProfile()},error:n=>{console.error("Error fetching company:",n),this.error="Failed to load company information",this.isLoading=!1,this.snackBar.open(this.error,"Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"bottom"})}})}loadCompanyProfile(){if(!this.companyId){this.error="No company found",this.isLoading=!1;return}this.isLoading=!0,this.error=null,this.companyService.getCompanyById(this.companyId).subscribe({next:e=>{this.updateForm.patchValue({name:e.name,description:e.description,industry:e.industry,location:e.location,website:e.website}),this.isLoading=!1},error:e=>{console.error("Error fetching company profile:",e),this.error=e.error?.message||"Failed to load company profile",this.isLoading=!1,this.snackBar.open(this.error||"An error occurred","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"bottom"})}})}onSubmit(){this.updateForm.valid&&this.companyId&&(this.isSubmitting=!0,this.companyService.updateCompany(this.companyId,this.updateForm.value).subscribe({next:()=>{this.snackBar.open("Company profile updated successfully","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"}),this.router.navigate(["/company",this.companyId])},error:e=>{console.error("Error updating company profile:",e),this.error=e.error?.message||"Failed to update company profile",this.snackBar.open(this.error||"An error occurred","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"bottom"}),this.isSubmitting=!1}}))}onCancel(){this.router.navigate(["/company",this.companyId])}retryLoading(){this.loadCompanyProfile()}static \u0275fac=function(n){return new(n||r)(f(k),f(ne),f(T),f(M),f(re))};static \u0275cmp=b({type:r,selectors:[["app-employer-profile-update"]],decls:4,vars:3,consts:[[1,"profile-update-container"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],["class","profile-update-card",4,"ngIf"],[1,"loading-container"],["animation","spin","size","2x",3,"icon"],[1,"error-container"],[1,"error-card"],["mat-raised-button","","color","primary",3,"click"],[1,"profile-update-card"],[1,"profile-update-form",3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline"],["matInput","","formControlName","name","placeholder","Enter company name"],[4,"ngIf"],["matInput","","formControlName","industry","placeholder","Enter industry"],["matSuffix",""],[3,"icon"],["appearance","outline",1,"full-width"],["matInput","","formControlName","description","placeholder","Enter company description","rows","4"],["matInput","","formControlName","location","placeholder","Enter location"],["matInput","","formControlName","website","placeholder","Enter website URL"],[1,"form-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(n,p){n&1&&(i(0,"div",0),s(1,ae,4,1,"div",1)(2,me,7,1,"div",2)(3,ue,44,11,"mat-card",3),t()),n&2&&(o(),m("ngIf",p.isLoading),o(),m("ngIf",p.error),o(),m("ngIf",!p.isLoading&&!p.error))},dependencies:[P,E,K,H,Y,J,W,V,q,ee,$,Q,X,Z,ie,te,O,L,F,w,U,B,N,G,D],styles:[".profile-update-container[_ngcontent-%COMP%]{padding:20px;min-height:400px}.profile-update-card[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.profile-update-form[_ngcontent-%COMP%]{padding:20px 0}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;gap:20px}.error-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:20px}.error-card[_ngcontent-%COMP%]{text-align:center;padding:20px}mat-form-field[_ngcontent-%COMP%]{width:100%}"]})};export{oe as ProfileUpdateComponent};
