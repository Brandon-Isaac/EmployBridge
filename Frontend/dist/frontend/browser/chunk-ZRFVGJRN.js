import{a as ie}from"./chunk-A65BIHRC.js";import{b as te,c as ne}from"./chunk-PLXGXVI2.js";import{b as G}from"./chunk-R5WRYQNY.js";import{a as ee}from"./chunk-Z5H657VF.js";import{$b as S,Bc as T,Ec as V,Ed as L,Fa as i,Fc as N,Gb as F,Gd as U,Ic as D,Id as A,Ja as p,Je as q,Kc as R,Oa as M,Pe as Y,Sa as _,Te as $,Ue as J,Ve as K,Wd as H,Xd as z,Ye as W,Za as s,Ze as X,_b as O,ac as w,ef as Z,gb as o,ge as j,ha as l,hb as a,hc as k,ia as d,ib as c,if as oe,mb as v,ob as g,pb as f,sc as I,tb as y,ub as x,uc as C,vb as P,ve as Q,xb as h,xc as B,yb as u,yc as E}from"./chunk-ZYTV455T.js";var re=["chatMessages"],se=(r,t)=>({message:!0,"user-message":r,"bot-message":t});function me(r,t){if(r&1&&(o(0,"div",13)(1,"div",14),c(2,"fa-icon",4),a(),o(3,"div",15)(4,"div",16),h(5),a(),o(6,"div",17),h(7),a()()()),r&2){let e=t.$implicit,n=f();s("ngClass",F(4,se,e.isFromUser,!e.isFromUser)),i(2),s("icon",e.isFromUser?n.faUser:n.faRobot),i(3),u(e.content),i(2),u(n.chatbotService.formatTimestamp(e.timestamp))}}function ce(r,t){if(r&1&&(o(0,"div",18)(1,"div",14),c(2,"fa-icon",4),a(),o(3,"div",15)(4,"div",19),c(5,"span")(6,"span")(7,"span"),a()()()),r&2){let e=f();i(2),s("icon",e.faRobot)}}var ae=class r{constructor(t,e,n){this.chatbotService=t;this.formBuilder=e;this.snackBar=n;this.chatForm=this.formBuilder.group({message:["",[C.required,C.minLength(1)]]})}messages=[];chatForm;isLoading=!1;faPaperPlane=Y;faTrash=Q;faUser=j;faRobot=q;chatMessages;ngOnInit(){this.loadChatHistory()}ngAfterViewChecked(){this.scrollToBottom()}loadChatHistory(){this.chatbotService.getChatHistory().subscribe({next:t=>{this.messages=t},error:t=>{console.error("Error loading chat history:",t),this.snackBar.open("Failed to load chat history. Please try again.","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"bottom"})}})}sendMessage(){if(this.chatForm.valid&&!this.isLoading){let t=this.chatForm.get("message")?.value;this.isLoading=!0,this.chatForm.disable(),this.chatbotService.sendMessage(t).subscribe({next:e=>{this.messages.push({id:Date.now().toString(),content:t,isFromUser:!0,timestamp:new Date,userId:"current-user"}),this.messages.push({id:(Date.now()+1).toString(),content:e.response,isFromUser:!1,timestamp:new Date,userId:"bot"}),this.chatForm.reset(),this.isLoading=!1,this.chatForm.enable()},error:e=>{console.error("Error sending message:",e),this.snackBar.open("Failed to send message. Please try again.","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"bottom"}),this.isLoading=!1,this.chatForm.enable()}})}}clearChat(){this.chatbotService.clearHistory().subscribe({next:()=>{this.messages=[],this.snackBar.open("Chat history cleared.","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})},error:t=>{console.error("Error clearing chat history:",t),this.snackBar.open("Failed to clear chat history. Please try again.","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"bottom"})}})}scrollToBottom(){try{this.chatMessages.nativeElement.scrollTop=this.chatMessages.nativeElement.scrollHeight}catch{}}static \u0275fac=function(e){return new(e||r)(p(ie),p(D),p(oe))};static \u0275cmp=M({type:r,selectors:[["app-employer-chatbot"]],viewQuery:function(e,n){if(e&1&&y(re,5),e&2){let m;x(m=P())&&(n.chatMessages=m.first)}},decls:18,vars:6,consts:[["chatMessages",""],[1,"chatbot-container"],[1,"chatbot-card"],["mat-icon-button","",1,"clear-button",3,"click"],[3,"icon"],[1,"chatbot-content"],[1,"chat-messages"],[3,"ngClass",4,"ngFor","ngForOf"],["class","message bot-message",4,"ngIf"],[1,"chat-input",3,"ngSubmit","formGroup"],[1,"message-input"],["matInput","","formControlName","message","placeholder","Type your message...",3,"keyup.enter"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"ngClass"],[1,"message-icon"],[1,"message-content"],[1,"message-text"],[1,"message-timestamp"],[1,"message","bot-message"],[1,"message-text","typing-indicator"]],template:function(e,n){if(e&1){let m=v();o(0,"div",1)(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title"),h(4,"AI Assistant"),a(),o(5,"button",3),g("click",function(){return l(m),d(n.clearChat())}),c(6,"fa-icon",4),a()(),o(7,"mat-card-content")(8,"div",5)(9,"div",6,0),_(11,me,8,7,"div",7)(12,ce,8,1,"div",8),a(),o(13,"form",9),g("ngSubmit",function(){return l(m),d(n.sendMessage())}),o(14,"mat-form-field",10)(15,"input",11),g("keyup.enter",function(){return l(m),d(n.sendMessage())}),a()(),o(16,"button",12),c(17,"fa-icon",4),a()()()()()()}e&2&&(i(6),s("icon",n.faTrash),i(5),s("ngForOf",n.messages),i(),s("ngIf",n.isLoading),i(),s("formGroup",n.chatForm),i(3),s("disabled",!n.chatForm.valid||n.isLoading),i(),s("icon",n.faPaperPlane))},dependencies:[k,O,S,w,X,$,K,W,J,A,U,L,ee,Z,ne,te,R,T,I,B,E,V,N,G,z,H],styles:[".chatbot-container[_ngcontent-%COMP%]{padding:20px}.chatbot-card[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;height:600px;display:flex;flex-direction:column}.chatbot-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-messages[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:20px;background:#f5f5f5;border-radius:4px;margin-bottom:20px;display:flex;flex-direction:column;gap:16px}.message[_ngcontent-%COMP%]{display:flex;gap:12px;max-width:80%}.user-message[_ngcontent-%COMP%]{align-self:flex-end;flex-direction:row-reverse}.bot-message[_ngcontent-%COMP%]{align-self:flex-start}.message-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#e0e0e0}.user-message[_ngcontent-%COMP%]   .message-icon[_ngcontent-%COMP%]{background:#1976d2;color:#fff}.bot-message[_ngcontent-%COMP%]   .message-icon[_ngcontent-%COMP%]{background:#424242;color:#fff}.message-content[_ngcontent-%COMP%]{background:#fff;padding:12px;border-radius:8px;box-shadow:0 2px 4px #0000001a}.user-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:#e3f2fd}.message-text[_ngcontent-%COMP%]{margin-bottom:4px}.message-timestamp[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.chat-input[_ngcontent-%COMP%]{display:flex;gap:10px;padding:10px 0}.message-input[_ngcontent-%COMP%]{flex:1}.clear-button[_ngcontent-%COMP%]{margin-left:auto}.typing-indicator[_ngcontent-%COMP%]{display:flex;gap:4px;padding:8px 0}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:8px;height:8px;background:#666;border-radius:50%;animation:_ngcontent-%COMP%_typing 1s infinite ease-in-out}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){animation-delay:.4s}@keyframes _ngcontent-%COMP%_typing{0%,to{transform:translateY(0)}50%{transform:translateY(-4px)}}"]})};export{ae as ChatbotComponent};
